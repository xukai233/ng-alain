<wimi-breadcrumb title="租户" icon="appstore" [data]="breadcrumb"></wimi-breadcrumb>
<wimi-table>
  <div name="head" style="display: flex;justify-content: space-between;align-items: center;">
    <form nz-form class="wimi-search" nzLayout="inline" nzFlex="true" style="flex:auto">
      <div style="width: 80px;">
        <a style="margin-left:8px;font-size:12px;" (click)="toggleCollapse()">
          {{isCollapse?'高级搜索':'收起'}}
            <i nz-icon [type]="isCollapse?'down':'up'"></i>
        </a>
      </div>
      <div style="flex:auto">
        <nz-input-group *ngIf="isCollapse" nzSearch [nzSuffix]="suffixButton" style="width: 60%">
          <input type="text" nz-input placeholder="编号/名称" name="filter" [(ngModel)]="filterTenants.filter">
        </nz-input-group>
        <ng-template #suffixButton>
          <button nz-button nzType="primary" nzSearch (click)="handleSearch()" [nzLoading]="isLoading">查询</button>
        </ng-template>
      </div>
    </form>
    <button nz-button nzType="primary" (click)="createTenant()"><i nz-icon type="plus"></i>新建租户</button>
  </div>
  <div *ngIf="!isCollapse" class="search-detail" name="head" nz-row nzType="flex">
    <div nz-col nzSpan="20">
      <wimi-form-item text="编号" class="wimi-form-item">
        <input nz-input placeholder="请输入" [(ngModel)]="filterTenants.tenantCode">
      </wimi-form-item>
      <wimi-form-item text="名称" class="wimi-form-item">
        <input nz-input placeholder="请输入" [(ngModel)]="filterTenants.tenantName">
      </wimi-form-item>
      <wimi-form-item text="APP授权" class="wimi-form-item">
        <input nz-input placeholder="请输入" [(ngModel)]="filterTenants.appId">
      </wimi-form-item>
      <wimi-form-item text="创建时间" style="width: 500px;">
        <nz-range-picker [nzStyle]="rangePickerStyle" nzShowTime [(ngModel)]="filterTenants.createDateStart"></nz-range-picker>
      </wimi-form-item>
    </div>
    <div nz-col nzSpan="4"><button nz-button nzType="primary" nzSearch>查询</button></div>
  </div>
  <nz-table name="table" #basicTable [nzData]="dataSet" nzShowQuickJumper nzShowSizeChanger [nzShowTotal]="totalTemplate" nzSize="middle" [nzLoading]="isLoading">
    <thead>
      <tr>
        <th>租户编号</th>
        <th>租户名称</th>
        <th>结束订阅日期</th>
        <th>启用</th>
        <th>创建时间</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of basicTable.data">
        <td>{{data.code}}</td>
        <td>{{data.name}}</td>
        <td>{{data.expiryTime}}</td>
        <td><nz-badge nzStatus="success" [nzText]="data.isActive"></nz-badge></td>
        <td>{{data.createTime}}</td>
        <td>
          <a (click)="handleUpdateTenant(data.id)">修改</a>
          <nz-divider nzType="vertical"></nz-divider>
          <a (click)="handleDelete()">回收</a>
          <nz-divider nzType="vertical"></nz-divider>
          <a nz-popconfirm nzTitle="确定停用该租户?">停用</a>
        </td>
      </tr>
    </tbody>
  </nz-table>
  <ng-template #totalTemplate let-total>
      共 {{total}} 条结果
  </ng-template>
</wimi-table>

<app-tenant-create-modal #createTenantModal (modalSave)="getTenants()"></app-tenant-create-modal>
<app-tenant-update-modal #updateTenantModal (modalSave)="getTenants()"></app-tenant-update-modal>